<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin • New Business Follow-Up</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--primary:#1a5f7a;--secondary:#457b9d;--accent:#a8dadc;--bg:#f8f9fa;--text:#2c3e50;--radius:12px;--shadow:0 8px 30px rgba(0,0,0,.08)}
body{margin:0;background:var(--bg);color:var(--text);font-family:"Plus Jakarta Sans",sans-serif}
.wrap{max-width:1100px;margin:0 auto;padding:24px}
.header{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border-radius:var(--radius);padding:28px;text-align:center;margin-bottom:16px}
.card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;margin-bottom:14px}
.grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}
label{font-size:.875rem;margin-bottom:6px;display:block}
input,select,button{width:100%;padding:12px;border-radius:10px;border:1px solid #d9e2ec;font-size:1rem}
button{background:linear-gradient(135deg,var(--secondary),var(--primary));color:#fff;border:none;cursor:pointer}
button:hover{filter:brightness(1.05)}
pre{white-space:pre-wrap;background:#0b1020;color:#e7e7e7;padding:12px;border-radius:10px;overflow:auto}
.pill{display:inline-block;background:var(--accent);color:#084c61;border-radius:999px;padding:6px 12px;font-size:.875rem}
</style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <h1>Admin • New Business Follow-Up</h1>
    <div class="pill">Bill Layne Insurance • Elkin, NC</div>
  </div>

  <div class="card">
    <h2 style="margin-top:0;color:var(--primary)">Initialize / Verify Sheets</h2>
    <button id="initBtn">Initialize System</button>
    <pre id="initOut">Click to create headers/tabs if missing.</pre>
  </div>

  <div class="card">
    <h2 style="margin-top:0;color:var(--primary)">Add Client</h2>
    <div class="grid">
      <div><label>Name</label><input id="name"></div>
      <div><label>Email</label><input id="email"></div>
      <div><label>Phone</label><input id="phone"></div>
      <div><label>Company</label><input id="company"></div>
      <div><label>Product/LOB</label><input id="product"></div>
      <div><label>Policy # (optional)</label><input id="policy"></div>
      <div><label>Notes (optional)</label><input id="notes"></div>
    </div>
    <div class="grid" style="margin-top:10px">
      <div><label>Docs Received</label>
        <div class="grid">
          <label><input type="checkbox" id="rcv_application"> Application</label>
          <label><input type="checkbox" id="rcv_photos"> Photos</label>
          <label><input type="checkbox" id="rcv_mvr"> MVR</label>
          <label><input type="checkbox" id="rcv_priorInsurance"> Prior Ins</label>
          <label><input type="checkbox" id="rcv_inspection"> Inspection</label>
          <label><input type="checkbox" id="rcv_payment"> Payment</label>
        </div>
      </div>
    </div>
    <div style="margin-top:12px"><button id="addBtn">Add Client</button></div>
    <pre id="addOut">Awaiting action…</pre>
  </div>

  <div class="card">
    <h2 style="margin-top:0;color:var(--primary)">Update Document Status</h2>
    <div class="grid">
      <div><label>Client ID or Email</label><input id="qid"></div>
      <div>
        <label>Document</label>
        <select id="dtype">
          <option value="application">Application</option>
          <option value="photos">Photos</option>
          <option value="mvr">MVR</option>
          <option value="priorInsurance">Prior Insurance</option>
          <option value="inspection">Inspection</option>
          <option value="payment">Payment</option>
          <option value="other">Other</option>
        </select>
      </div>
      <div>
        <label>Status</label>
        <select id="dstatus">
          <option>Pending</option>
          <option>Received</option>
          <option>N/A</option>
        </select>
      </div>
      <div style="align-self:end"><button id="upBtn">Update</button></div>
    </div>
    <pre id="upOut">Awaiting action…</pre>
  </div>
</div>

<script>
  // >>>>>> PASTE YOUR NEW /exec URL HERE <<<<<<
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwUXWw8BWT8EJ_zQbwwu2iWHn5mDSTcZjTl0gAlVGEfqgFETHgIKUDrSrHh4dDI_88XLw/exec";

  async function getJSON(url){const r=await fetch(url);if(!r.ok)throw new Error('HTTP '+r.status);return r.json();}
  async function postJSON(body){
    const r = await fetch(WEB_APP_URL,{
      method:'POST',
      headers:{'Content-Type':'text/plain'}, // avoids preflight
      body: JSON.stringify(body)
    });
    if(!r.ok) throw new Error('HTTP '+r.status);
    return r.json();
  }

  document.getElementById('initBtn').onclick = async ()=>{
    try{
      const url = WEB_APP_URL + '?action=init';
      const res = await getJSON(url);
      document.getElementById('initOut').textContent = JSON.stringify(res,null,2);
    }catch(e){ document.getElementById('initOut').textContent = String(e); }
  };

  document.getElementById('addBtn').onclick = async ()=>{
    const payload = {
      action:'addClient',
      name: document.getElementById('name').value.trim(),
      email: document.getElementById('email').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      company: document.getElementById('company').value.trim(),
      product: document.getElementById('product').value.trim(),
      policyNumber: document.getElementById('policy').value.trim(),
      notes: document.getElementById('notes').value.trim(),
      documentsReceived: {
        application: document.getElementById('rcv_application').checked,
        photos: document.getElementById('rcv_photos').checked,
        mvr: document.getElementById('rcv_mvr').checked,
        priorInsurance: document.getElementById('rcv_priorInsurance').checked,
        inspection: document.getElementById('rcv_inspection').checked,
        payment: document.getElementById('rcv_payment').checked
      }
    };
    if(!payload.name || !payload.email || !payload.company || !payload.product){
      document.getElementById('addOut').textContent = 'Name, Email, Company, and Product are required.';
      return;
    }
    try{
      const res = await postJSON(payload);
      document.getElementById('addOut').textContent = JSON.stringify(res,null,2);
    }catch(e){ document.getElementById('addOut').textContent = String(e); }
  };

  document.getElementById('upBtn').onclick = async ()=>{
    const clientIdOrEmail = document.getElementById('qid').value.trim();
    if(!clientIdOrEmail){ document.getElementById('upOut').textContent = 'Enter Client ID or Email'; return; }
    const body = {
      action:'updateStatus',
      clientId: clientIdOrEmail,
      documentType: document.getElementById('dtype').value,
      status: document.getElementById('dstatus').value
    };
    try{
      const res = await postJSON(body);
      document.getElementById('upOut').textContent = JSON.stringify(res,null,2);
    }catch(e){ document.getElementById('upOut').textContent = String(e); }
  };
</script>
</body>
</html>
